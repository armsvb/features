[SUBROUTINE]
icon = icons/array.png
name =  LinkUP
image = images/array.png
type = LinkUP
help = 	<big>Link up lines and arcs</big>		
		Drag and drop lines and arcs into Items parameter.
		X0 Y0 - Start point of chain
		close=0 not close contour, else - close
		X0 Y0 Parameters Depth DepthStep Rappid Surface FinalCut
		
order = 01 02 03 05 06 07 08 09 items
		
[PARAM_01]
name = X0
type = float
icon = icons/line-to.png
tool_tip = X0
value = 0

[PARAM_02]
name = Y0
type = float
icon = icons/line-to.png
tool_tip = Y0
value = 0

[PARAM_03]
name = close
type = float
icon = icons/close.png
tool_tip = Y0
value = 0

[PARAM_05]
name = Depth
type = float
icon = icons/height.png
tool_tip = Depth
value = #<_global_depth>

[PARAM_06]
name = Depth step
type = float
icon = icons/dz.png
tool_tip = Depth step per pass
value = #<_global_depth_step>

[PARAM_07]
name = Surface
type = float
icon = icons/dz.png
tool_tip = Surface height
value = #<_global_surface>

[PARAM_08]
name = Rappid
type = float
icon = icons/height.png
tool_tip = Rappid height
value = #<_global_rappid>

[PARAM_09]
name = Final cut
type = float
icon = icons/height.png
tool_tip = Rappid height
value = #<_global_final>


[PARAM_ITEMS]
name = Items
type = items
icon = icons/items.png
tool_tip = Drop Subroutines here


[DEFINITIONS]
content = 

[CALL]
content = 

[BEFORE]
content =

	(Linked multipass WHILE definition)
		#<x0> = [#param_01]
		#<y0> = [#param_02]
		#<close> = [#param_03]		
		#<depth> = [#param_05]
		#<step> = [#param_06]
		#<surface> = [#param_07]
		#<rappid> = [#param_08]
		#<final> = [#param_09]		
		#<flag>	= 0	
	
		G0 Z#<rappid>
		G0 X#<x0> Y#<y0>
		#<z> = #<surface>
		O<linked-multipass-while> WHILE [#<z> GT [#<depth>]]
			(Make next step cut)
			#<z> = [#<z>-#<step>]
			O<linked-multipass-if01> IF [#<flag> EQ 0]				
				O<linked-multipass-if02> IF [#<z> LE [#<depth>+#<final>]]
					(Make pre final cut)
					#<z>=[#<depth>+#<final>]
					#<flag> = 1
				O<linked-multipass-if02> ENDIF 
			O<linked-multipass-if01> ELSE
				(Make final cut)
				#<z>=[#<depth>] 
			O<linked-multipass-if01> ENDIF 
			G1 Z#<z>	
		
			(all items will be auto plased there)

[AFTER]
content = 
			O<linked-multipass-if03> IF [#<close> EQ 0]
				(Not close contour)
				G0 Z#<rappid>
				G0 X[#param_01] Y[#param_02]
				O<linked-multipass-if04> IF [#<z> NE [#<depth>]]
					G0 Z#<z>
				O<linked-multipass-if04> ENDIF 
			O<linked-multipass-if03> ELSE
				G1 X#param_01 Y#param_02
			O<linked-multipass-if03> ENDIF 
		
		O<linked-multipass-while> ENDWHILE
		G0 Z#<rappid>	
	(Linked multipass WHILE definition end)

